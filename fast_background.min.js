/**
 * Name:    FastBackground
 * Version: 1.3.0
 * Author:  Novojilov Pavel Andreevich
 * Support: https://github.com/showyweb/FastBackground
 * License: MIT license. http://www.opensource.org/licenses/mit-license.php
 * Copyright (c) 2017 Pavel Novojilov
 */
var fast_background={timeout:null,timeout_size:0,cssobj:null,prepare_selector_hook:function(e){return e},resize_event:!0,ajax_url:window.location.href,max_ajax_post_stream:8,_page_unloaded:!1,_fix_old_browsers:!1,_ajax_is_work:0,_p_post_ajax_work_streams:0,_last_update_callbacks:[],update:function(e,t,a){function i(e,t,a){if(p._p_post_ajax_work_streams>=p.max_ajax_post_stream)setTimeout(arguments.callee.bind(this,e,t,a),100);else{p._p_post_ajax_work_streams++;d.post(p.ajax_url.replace(window.location.hash,""),e,function(e){if(p._p_post_ajax_work_streams--,!p._page_unloaded){var i="<->ajax_complete<->";if(e.substring(e.length-i.length)!==i)return a?a(e):console.log("ERROR POST AJAX: "+e),void t(null);e=e.substring(0,e.length-i.length),t&&t(e)}}).fail(function(i,o,r){p._p_post_ajax_work_streams--,p._page_unloaded||(a?a("ERROR POST AJAX: <div style='white-space: pre-wrap; word-wrap:break-word;'>"+window.location.href+" "+(d.toJSON?d.toJSON(e):"")+"</div><br>ERROR TEXT: "+r):console.log("ERROR POST AJAX: "+r),t(null))})}}function o(e,t){var a=e.attr("id");if(a&&(a="#"+a),a||(a=e.is("body")?"fb_body":"fb_"+Math.random().toString(36).substr(2,9),e.attr("id",a),a="#"+a),t){a=a+(0===t.indexOf(":")?"":" ")+t}return a=p.prepare_selector_hook(a)}function r(){if(p._ajax_is_work--,p._ajax_is_work<1)if(p.is_init){if(e||p._last_update_callbacks.length){e&&e();for(var t=0;t<p._last_update_callbacks.length;t++)p._last_update_callbacks[t]();p._last_update_callbacks=[]}}else p.is_init=!0,p.update()}function s(e,t){var a=e.is("img")?p.types.img_src:p.types.b_url;switch(a){case p.types.b_url:var i=t;if(i||(i=o(e)),void 0===p.cssobj.obj[i])return"";var r=p.cssobj.obj[i][a];return r?r.replace(/url\(['"]?|['"]?\)/g,""):"";case p.types.img_src:return e.attr(a)}}function n(e,t,a,i){a||(a=e.width()),i||(i=e.height());return"fast_background_cached_url_"+(a-=a%10)+"x"+(i-=i%10)+"_"+t}function _(e,t,a,i,s,n){!function(e,t,a){if(p._p_post_ajax_work_streams>=p.max_ajax_post_stream)setTimeout(arguments.callee.bind(this,e,t,a),100);else if(e){p._p_post_ajax_work_streams++;var i=new Image;i.onload=function(){p._p_post_ajax_work_streams--,t&&t(i.naturalWidth,i.naturalHeight)},i.onerror=function(e){return p._p_post_ajax_work_streams--,e.preventDefault(),e.stopPropagation(),a&&a(),!1},e.indexOf("!important"),i.src=e}else a&&a()}(t,function(e,_){if(SW_BS.browser.isLocalStorageSupported)if(-1===t.indexOf("default_"))localStorage.setItem(n,t);else{var c="tmp_width"+(i?"_c_"+s:""),u="tmp_height"+(i?"_c_"+s:"");a.removeData(c),a.removeData(u)}!function(e,t,a){var i=t.is("img")?p.types.img_src:p.types.b_url;try{switch(i){case p.types.b_url:var s=a;s||(s=o(t)),void 0===p.cssobj.obj[s]&&(p.cssobj.obj[s]={});var n=p.cssobj.obj[s][i]&&-1!==p.cssobj.obj[s][i].indexOf(" !important");n||-1===f.indexOf(s)||(n=!0),p.cssobj.obj[s][i]="url("+e+")"+(n?" !important":""),p.cssobj.update(),n||(p._fix_old_browsers||"none"!==d(s).css("background-image")||(p._fix_old_browsers=!0),p._fix_old_browsers&&(p.cssobj.obj[s].backgroundImage="url("+e+")",p.cssobj.update()));break;case p.types.img_src:t.attr(i,e),l(function(){var e=d(window).width(),a=t.width();(e>500&&a>e||SW_BS.browser.isMobile.anyPhone&&a<10)&&t.css("width","100%")},t[0])}}catch(e){}r()}(t,a,i)},function(){localStorage.removeItem(n),function(e,t){switch(e.is("img")?p.types.img_src:p.types.b_url){case p.types.b_url:var a=t;a||(a=o(e)),void 0===p.cssobj.obj[a]&&(p.cssobj.obj[a]={}),p.cssobj.update();break;case p.types.img_src:}r()}(a,i)})}var l=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},c=function(e){var t=e.attr("data-urls");return void 0===t?{}:(t=t.replace(/'/gi,'"'),t=d.parseJSON(t))},u=function(e){return void 0!==e.attr("data-urls")},d=jQuery,p=fast_background;if("undefined"==typeof SW_BS){SW_BS={browser:{isLocalStorageSupported:"undefined"!=typeof localStorage,isMobile:{Android:!!navigator.userAgent.match(/Android/i),BlackBerry:!!navigator.userAgent.match(/BlackBerry|BB/i),iOS:!!navigator.userAgent.match(/iPhone|iPad|iPod/i),Windows:!!navigator.userAgent.match(/IEMobile/i)}}};var b=SW_BS.browser;if(b.isSessionStorageSupported="undefined"!=typeof sessionStorage,b.isSessionStorageSupported)try{sessionStorage.setItem("test_sessionStorage",1),sessionStorage.removeItem("test_sessionStorage")}catch(e){b.isLocalStorageSupported=!1,b.isSessionStorageSupported=!1}b.isMobile.any=b.isMobile.Android||b.isMobile.BlackBerry||b.isMobile.iOS||b.opera_mini||b.isMobile.Windows,b.isMobile.anyPhone=!!b.isMobile.any&&(!!navigator.userAgent.match(/iphone|ipod/i)||b.isMobile.Android&&!!navigator.userAgent.match(/mobile/i)||b.isMobile.BlackBerry&&!navigator.userAgent.match(/tablet/i)||b.isMobile.Windows),d("head").append('<style id="SW_BS" type="text/css"> .SW_BS_is_retina {display: none; opacity: 0; } @media only screen and (-Webkit-min-device-pixel-ratio: 1.5), only screen and (-moz-min-device-pixel-ratio: 1.5), only screen and (-o-min-device-pixel-ratio: 3 / 2), only screen and (min-device-pixel-ratio: 1.5), only screen and (-webkit-min-device-pixel-ratio: 3) {.SW_BS_is_retina {opacity: 1; }} </style>'),b.isRetinaDisplay=function(){if(void 0===d)return!1;if(b.is_error_version||b.isMobile.Android&&b.fullVersion<534||b.isMobile.BlackBerry&&b.fullVersion<537)return!1;d("body").append("<div id='test_SW_BS' class='is_retina'></div>");var e="1"==d("#test_.SW_BS_is_retina").css("opacity");return d("#test_SW_BS").remove(),d("#SW_BS").remove(),e}()}if(-1===window.location.host.indexOf("yandex.net")){var f=[];if(p._p_post_ajax_work_streams=0,0===p.timeout_size&&(p.timeout_size=1e3),p._ajax_is_work>0)return e&&p._last_update_callbacks.push(e),clearTimeout(p.timeout),void(p.timeout=setTimeout(arguments.callee.bind(this,null,t),p.timeout_size));p._page_unloaded=!1,null===p.cssobj&&(p.cssobj=cssobj({}));var g=d(".fast_background").toArray();g.length<1&&e&&e();var m,w,h=[];for(w=0;w<g.length;w++)!function(e){h.push(e);var t=null;if(!e.is_fb_class&&u(e)){var a=c(e);for(var i in a)if(a.hasOwnProperty(i)){var r=a[i];t=o(e,i);var s=d(t.replace(":hover","").replace(":active","").replace(":focus",""));s.length>0&&(s=s.eq(0)),h.push({is_fb_class:!0,first_elem:s,url:r,fb_selector:t})}}}(m=g[w].is_fb_class?g[w]:d(g[w]));for(p._ajax_is_work=h.length,w=0;w<h.length;w++)!function(e){var r=null,l=null,c=null,u=!1,b=null;if(e.is_fb_class)u=!0,b=m.first_elem,c=e.url,r=e.fb_selector,l=r?r.replace(/ |>|\*|\(|\)|\+|\@/gi,"_"):"",e=e.first_elem;else{if(!(c=e.attr("data-url")))return void p._ajax_is_work--;r=null}var g=e.is("img")?p.types.img_src:p.types.b_url;if(g===p.types.b_url){var w=r;if(w||(w=o(e)),void 0===p.cssobj.obj[w]||void 0===p.cssobj.obj[w][g]){p.cssobj.obj[w]={};-1!==c.indexOf(" !important")&&f.push(w)}c=c.replace(" !important","")}g!==p.types.img_src||e.attr("src")||e.attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=");var h=null,v=e.width(),S=e.height(),j=n(e,c,v,S);if(SW_BS.browser.isLocalStorageSupported&&!a&&(h=localStorage.getItem(j)))_(0,h,e,r,l,j);else{0===e.length&&(e=d(r.replace(/(\:| ).*$/gi,"")));var y="false",A=e.is("img")?"cover":e.css("background-size");if(u&&0===b.length&&(A="contain"),"cover"===A&&(y="true"),"cover"!==A&&"contain"!==A){var x=/^(|(\d*)(px|%|auto)) (|(\d*)(px|%|auto))$/i,k=A.match(x);null==k&&(x=/^(|(\d*)(px|%|auto))$/i,k=A.match(x));var B=!1,O=!1;if(null!=k){var W=e;g===p.types.img_src&&(W=e.parent()),"auto"!==k[3].toLowerCase()?(v=parseInt(k[2]),"%"===k[3].toLowerCase()&&(v>=100&&(y="true"),v=W.width()/100*v)):B=!0,7===k.length&&"auto"!==k[6].toLowerCase()?(S=parseInt(k[5]),"%"===k[6].toLowerCase()&&(S>=100&&(y="true"),S=W.height()/100*S)):(7===k.length||B)&&(O=!0)}B&&O&&(v=d(window).width(),S=d(window).height())}if(SW_BS.browser.isRetinaDisplay&&(v*=2,S*=2),v+=150,S+=150,!a){var R="tmp_width"+(u?"_c_"+l:""),M="tmp_height"+(u?"_c_"+l:""),I=parseInt(e.data(R));I||(I=0);var z=parseInt(e.data(M));if(z||(z=0),v<=I&&S<=z)return h=s(e,r),h=h.replace(" !important",""),void _(0,h,e,r,l,j);v>I?e.data(R,v):v=I,S>z?e.data(M,S):S=z}var P=v+"x"+S;u&&0===b.length&&(e=b),i({fast_background:"get_cached_url",web_url:c,cover_size:y,cont_size:P,other_size:p.is_init||g===p.types.img_src?"false":"true"},function(t){_(0,t,e,r,l,j)},t)}}(m=h[w].is_fb_class?h[w]:d(h[w]))}},types:{b_url:"background-image",img_src:"src"},is_init:!1,ajax_is_work:0};!function(){var e=jQuery;e(function(){e(window).on("beforeunload.fast_background",function(e){fast_background._page_unloaded=!0});var t=e(window).width();e(window).resize(function(){if(!fast_background.resize_event)return!0;var a=e(window).width();SW_BS.browser.isMobile.any&&t===a||!fast_background.is_init||-1===window.location.host.indexOf("yandex.net")&&(t=e(window).width(),fast_background.update())})})}();