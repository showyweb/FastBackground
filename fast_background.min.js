/**
 * Name:    FastBackground
 * Version: 3.1.4
 * Author:  Novojilov Pavel Andreevich (The founder of the library)
 * Support: https://github.com/showyweb/FastBackground
 * License: MIT license. http://www.opensource.org/licenses/mit-license.php
 * Copyright (c) 2017 Pavel Novojilov
 */
var fast_background=null;!function(){function e(e){return!/(\/(m_)?def_|^data:)/.test(e)}function a(e,a,t){if(p>=_.max_ajax_post_stream)setTimeout(arguments.callee.bind(this,e,a,t),100);else{p++,_.is_debug_pws&&(console.log("ajax begin"),console.log("pws "+p));c.post(_.ajax_url.replace(window.location.hash,""),e,function(e){if(p--,_.is_debug_pws&&(console.log("ajax end"),console.log("pws "+p)),!g){var o="<->ajax_complete<->";if(e.substring(e.length-o.length)!==o)return t?t(e):console.log("ERROR POST AJAX: "+e),void a(null);e=e.substring(0,e.length-o.length),a&&a(e)}}).fail(function(o,i,s){p--,_.is_debug_pws&&(console.log("ajax fail"),console.log("pws "+p)),g||(t?t("ERROR POST AJAX: <div style='white-space: pre-wrap; word-wrap:break-word;'>"+window.location.href+" "+(c.toJSON?c.toJSON(e):"")+"</div><br>ERROR TEXT: "+s):console.log("ERROR POST AJAX: "+s),a(null))})}}function t(e,a,t,o){if(!o){if(!e)return void(t&&t(e));x.push([e,a,t])}var i=p>=_.max_ajax_post_stream;if(i&&null===k&&(k=setInterval(arguments.callee.bind(this,null,null,null,!0),10)),!i&&x.length){var s=x[0];e=s[0],a=s[1],t=s[2],x.splice(0,1),x.length||(clearInterval(k),k=null),p++,_.is_debug_pws&&(console.log("load_img "+e),console.log("pws "+p));var r=new Image;r.onload=function(){p--,_.is_debug_pws&&(console.log("loaded_img "+e),console.log("pws "+p)),a&&a(e)},r.onerror=function(a){return p--,_.is_debug_pws&&(console.log("img on error "+e),console.log("pws "+p)),a.preventDefault(),a.stopPropagation(),t&&t(),!1},r.src=e,x.length&&arguments.callee.apply(this,null,null,null,!0)}}function o(e,a){var t=e.attr("id");if(t&&(t="#"+t),t||(t=e.is("body")?"fb_body":"fb_"+Math.random().toString(36).substr(2,9),e.attr("id",t),t="#"+t),a){t=t+(0===a.indexOf(":")?"":" ")+a}return t=_.prepare_selector_hook(t)}function i(a,t,i,s){e(a)&&(t.hasClass("fb_loaded")&&(t.removeClass("fb_loaded"),t.addClass("fb_dynamic_url")),t.hasClass("fb_dynamic_url")||t.addClass("fb_loaded"),t.data("fb_last_load_url",a));var r=t&&t.is("img")?v.img_src:v.b_url;try{switch(r){case v.b_url:var n=i;n||(n=o(t)),void 0===_.cssobj.obj[n]&&(_.cssobj.obj[n]={});var l=!l&&-1!==h.indexOf(n),d="url("+a+")"+(l?" !important":"");_.cssobj.obj[n][r]&&_.cssobj.obj[n][r]!==d&&(!0,_.cssobj.obj[n][r]="none",_.cssobj.obj[n].backgroundImage="none",s||_.cssobj.update()),_.cssobj.obj[n][r]=d,_.cssobj.obj[n].backgroundImage=d,s||_.cssobj.update();break;case v.img_src:t.attr(r,a),y(function(){var e=c(window).width(),a=t.width();(e>500&&a>e||u.isMobile.anyPhone&&a<10)&&t.css("width","100%")},t[0])}t.hasClass("fb_ev_img_load")&&t.trigger("fb_ev_img_load")}catch(e){console.warn(e.message)}S()}function s(e,a,t,o){t||(t=e.width()),o||(o=e.height());return"fast_background_cached_url_"+(t-=t%10)+"x"+(o-=o%10)+"_"+a}function r(a,s,r,n,l,d,_){function c(){j.del(d),S()}if(s){if(!s||/(^data:)/.test(s)||_||j.set(d,s),!e(s)){var u="tmp_width"+(n?"_c_"+l:""),g="tmp_height"+(n?"_c_"+l:"");r.removeData(u),r.removeData(g)}var f=r[0].getBoundingClientRect();!m&&(!z||A[n||o(r)]||r.hasClass("fb_ignore_io"))||m&&f.top<w&&f.height?t(s,function(){i(s,r,n)},c):S()}else c()}function n(e){return!A[e]&&(A[e]=!0,!0)}function l(e,a,o){a=a.replace(" !important",""),a+=":"+e.data("fb_img_type");var r=s(e,a),n=j.get(r);!n||e.hasClass("fb_loaded")&&e.data("fb_last_load_url")===n?z&&z.unobserve(e[0]):(_.ajax_is_work++,t(n,function(){z&&z.unobserve(e[0]),i(n,e,o)},function(){j.del(r),S()}))}if(-1===window.location.host.indexOf("yandex.net")){var d=!1,_=fast_background={resize_event:!0,ajax_url:window.location.href,max_ajax_post_stream:8,ajax_is_work:0,update_is_worked:!1,stage_loaded:-1,timeout_size:0,cssobj:null,img_types:{jpg:2,png:3,webp:18},is_debug_pws:!1,use_local_storage:!0,prepare_selector_hook:function(e){return e},update:function(t,n,l){if(0===_.timeout_size&&(_.timeout_size=50),_.update_is_worked&&!d||-1!==_.stage_loaded&&!R)return t&&b.push(t),clearTimeout(f),void(f=setTimeout(arguments.callee.bind(this,null,n),_.timeout_size));switch(d=!1,_.update_is_worked=!0,_.stage_loaded){case-1:_.stage_loaded=0;break;case 3:_.stage_loaded=1}p=0,_.is_debug_pws&&console.log("pws set "+p),g=!1,null===_.cssobj&&(_.cssobj=cssobj({})),null===u&&function(){u={isMobile:{Android:!!navigator.userAgent.match(/Android/i),BlackBerry:!!navigator.userAgent.match(/BlackBerry|BB/i),iOS:!!navigator.userAgent.match(/iPhone|iPad|iPod/i),Windows:!!navigator.userAgent.match(/IEMobile/i)},isLocalStorageSupported:!1,isSessionStorageSupported:!1};try{u.isLocalStorageSupported="undefined"!=typeof localStorage,u.isSessionStorageSupported="undefined"!=typeof sessionStorage}catch(e){console.log(e.message)}if(u.isSessionStorageSupported)try{sessionStorage.setItem("test_sessionStorage",1),sessionStorage.removeItem("test_sessionStorage")}catch(e){u.isLocalStorageSupported=!1,u.isSessionStorageSupported=!1}u.isMobile.any=u.isMobile.Android||u.isMobile.BlackBerry||u.isMobile.iOS||u.opera_mini||u.isMobile.Windows,u.isMobile.anyPhone=!!u.isMobile.any&&(!!navigator.userAgent.match(/iphone|ipod/i)||u.isMobile.Android&&!!navigator.userAgent.match(/mobile/i)||u.isMobile.BlackBerry&&!navigator.userAgent.match(/tablet/i)||u.isMobile.Windows),u.isRetinaDisplay=function(){c("head").append('<style id="FB_BS" type="text/css"> .FB_BS_is_retina {display: none; opacity: 0; } @media only screen and (-Webkit-min-device-pixel-ratio: 1.5), only screen and (-moz-min-device-pixel-ratio: 1.5), only screen and (-o-min-device-pixel-ratio: 3 / 2), only screen and (min-device-pixel-ratio: 1.5), only screen and (-webkit-min-device-pixel-ratio: 3) {.FB_BS_is_retina {opacity: 1; }} </style>');var e=c("<div id='test_FB_BS' class='FB_BS_is_retina'></div>");c("body").append(e);var a=1==e.css("opacity");return e.remove(),c("#FB_BS").remove(),a}(),u.isWebpSupport=function(){var e="object"==typeof document?document.createElement("canvas"):{};return e.width=e.height=1,!!e.toDataURL&&5===e.toDataURL("image/webp").indexOf("image/webp")}()}(),S=null,S=function(){if(_.ajax_is_work--,_.is_debug_pws&&console.log("ajax_is_work "+_.ajax_is_work),_.ajax_is_work<1)if(_.stage_loaded<2)_.stage_loaded<1?(_.cssobj.update(),_.stage_loaded=1,z||(m=!1,R=!0)):_.stage_loaded=2,d=!0,_.update(t,n,l);else{_.stage_loaded=3,t&&t();for(var e=0;e<b.length;e++)b[e]();b=[],_.update_is_worked=!1}};var w=[],y=c(".fast_background:not(.fb_loaded)").toArray(),x=[];for(A=0;A<y.length;A++)x.push(c(y[A]));y=x,x=null;var k,A;for(A=0;A<y.length;A++){var B=o(k=y[A]);if(w.push(k),(!k.data("is_fb_observed")||k.attr("data-url")&&!k.data("fb_sel"))&&(k.data("is_fb_observed",!0),k.data("fb_sel",B),z&&z.observe(k[0])),!k.is_fb_class&&O.all_exist(k)){var I=O.get_all(k);for(var M in I)if(I.hasOwnProperty(M)){var C=I[M];B=o(k,M);var L=c(B.replace(":hover","").replace(":active","").replace(":focus",""));if(L.length>0){for(var F=0;F<1;F++){var P=L.eq(F);P.data("is_fb_observed")||P.data("is_fb_observed",!0),z&&z.observe(P[0]);var T=null;P.data("fb_sels")?T=P.data("fb_sels"):(T={},P.data("fb_sels",T)),T[B]=!0}var E=L.eq(0)}w.push({is_fb_class:!0,first_elem:E,url:C,fb_selector:B})}}}if(_.ajax_is_work=w.length,_.ajax_is_work<1)t&&t();else{var q=[];for(A=0;A<w.length;A++)!function(t){var d=null,g=null,f=null,p=!1,b=null;if(t.is_fb_class){if(p=!0,b=k.first_elem,f=t.url,d=t.fb_selector,g=d?d.replace(/ |>|\*|\(|\)|\+|\@/gi,"_"):"",!(t=t.first_elem))return void _.ajax_is_work--}else{if(!(f=t.attr("data-url")))return void _.ajax_is_work--;d=null}var m=f?f.split(":"):[null];f=m[0],m[1]||(m[1]=null);var w=_.img_types[m[1]]?_.img_types[m[1]]:0;0===w&&(w=_.img_types.webp),w!==_.img_types.webp||u.isWebpSupport||(w=0);var y=t.is("img")?v.img_src:v.b_url;if(y===v.b_url){var x=d;if(x||(x=o(t)),void 0===_.cssobj.obj[x]||void 0===_.cssobj.obj[x][y]){_.cssobj.obj[x]={};-1!==f.indexOf(" !important")&&h.push(x)}f=f.replace(" !important","")}var O=null,A=t.width(),B=t.height();t.data("fb_img_type",w);var R=s(t,f+":"+w,A,B);if(!l&&(O=j.get(R))&&e(O))_.stage_loaded<1?i(O,t,d,!0):r(0,O,t,d,g,R,!0);else{0===t.length&&(t=c(d.replace(/(\:| ).*$/gi,"")));var z=!1,I=y===v.img_src?"cover":t.css("background-size");p&&0===b.length&&(I="contain"),"cover"===I&&(z=!0);var M=null;if("cover"!==I&&"contain"!==I){var C=/^(|(\d*)(px|%|auto)) (|(\d*)(px|%|auto))$/i,L=I.match(C);null==L&&(C=/^(|(\d*)(px|%|auto))$/i,L=I.match(C));var F=!1,P=!1;null!=L&&(M=t,L[3]&&"auto"!==L[3].toLowerCase()?(A=parseInt(L[2]),"%"===L[3].toLowerCase()&&(A>=100&&(z=!0),A=M.width()/100*A,A+=10)):F=!0,7===L.length&&L[6]&&"auto"!==L[6].toLowerCase()?(B=parseInt(L[5]),"%"===L[6].toLowerCase()&&(B>=100&&(z=!0),B=M.height()/100*B,B+=10)):(7===L.length||F)&&(P=!0)),F&&P?(A=c(window).width(),B=c(window).height()):(F||P)&&(z=!0)}else y===v.img_src&&-1!==[A,B].indexOf(0)&&(M=t.parent(),0===A?A=M.width():0===B&&(B=M.height()));z=z?1:0;var T=_.stage_loaded>=1?_.stage_loaded>=2?0:1:2;if(u.isRetinaDisplay&&(A*=2,B*=2),!l){var E="tmp_width"+(p?"_c_"+g:""),D="tmp_height"+(p?"_c_"+g:""),J=parseInt(t.data(E));J||(J=0);var W=parseInt(t.data(D));if(W||(W=0),A<=J&&B<=W&&!t.hasClass("fb_dynamic_url")&&(O=function(e,a){var t=e.is("img")?v.img_src:v.b_url;switch(t){case v.b_url:var i=a;if(i||(i=o(e)),void 0===_.cssobj.obj[i])return"";var s=_.cssobj.obj[i][t];return s?s.replace(/url\(['"]?|['"]?\)/g,""):"";case v.img_src:var r=e.attr(t);return void 0===r&&(r=""),r}}(t,d),O=O.replace(" !important","")))return void r(0,O,t,d,g,R,!0);_.stage_loaded>=1&&(A>J?t.data(E,A):A=J,B>W?t.data(D,B):B=W)}if(A||B){var N=A+"x"+B;p&&0===b.length&&(t=b),_.stage_loaded<2?q.push({img_obj:t,fb_selector:d,fb_tmp_attr_p:g,cached_key:R,web_url:f,cover_size:z,cont_size:N,def_size:T,end_type:w}):a({fast_background:"get_cached_url",web_url:f,cover_size:z,cont_size:N,def_size:T,end_type:w},function(e){r(0,e,t,d,g,R)},n)}else S()}}(k=w[A].is_fb_class?w[A]:c(w[A]));if(_.stage_loaded<2){for(var D={web_url:"",cover_size:"",cont_size:"",def_size:"",end_type:""},J=function(e,a){D[a]+=q[e][a]+":"},W=0;W<q.length;W++)for(var N in D)D.hasOwnProperty(N)&&J(W,N);D.fast_background="get_cached_urls",a(D,function(e){if(e){e=e.split(":");for(var a=0;a<q.length;a++)r(q[a].url,e[a],q[a].img_obj,q[a].fb_selector,q[a].fb_tmp_attr_p,q[a].cached_key)}},n)}}}},c=jQuery,u=null,g=!1,f=null,p=0,b=[],v={b_url:"background-image",img_src:"src"},h=[],m=!0,w=c(window).height(),j={data:{},get:function(e){return!this.data[e]&&u.isLocalStorageSupported&&(this.data[e]=localStorage.getItem(e)),this.data[e]},set:function(e,a){this.data[e]=a,u.isLocalStorageSupported&&_.use_local_storage&&localStorage.setItem(e,a)},del:function(e){this.data[e]&&(delete this.data[e],u.isLocalStorageSupported&&localStorage.removeItem(e))}};c(function(){c(window).on("beforeunload.fast_background",function(e){g=!0});var e=c(window).width();c(window).resize(function(){if(!_.resize_event)return!0;var a=c(window).width();_.stage_loaded<2||u.isMobile.any&&e===a||-1===window.location.host.indexOf("yandex.net")&&(c(".fb_loaded").removeClass("fb_loaded"),e=c(window).width(),_.update())}),c(document).on("scroll mousemove touchstart",function(e){m&&_.stage_loaded>0&&(m=!1,fast_background.update())})});var y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,a){window.setTimeout(e,1e3/60)},S=null,x=[],k=null,O={get_all:function(e){var a=e.attr("data-urls");return void 0===a?{}:(a=a.replace(/'/gi,'"'),a=c.parseJSON(a))},get:function(e,a){return this.get_all(e)[a]},set_all:function(e,a){var t=c.toJSON(a);t=t.replace(/\"/gi,"'"),e.attr("data-urls",t),isEmptyObject(a)&&this.del_all(e)},set:function(e,a,t){var o=this.get_all(e);o[a]=t,this.set_all(e,o)},del_all:function(e){e.removeAttr("data-urls")},del:function(e,a){var t=this.get_all(e);delete t[a],this.set_all(e,t)},all_exist:function(e){return void 0!==e.attr("data-urls")}},A={},B=null,R=!1,z="IntersectionObserver"in window?new IntersectionObserver(function(e){R||(clearTimeout(B),B=setTimeout(function(){R=!0},100));for(var a in e){var t=e[a];if(t.isIntersecting){var o=c(t.target),i=o.data("fb_sel"),s=null;i&&n(i)&&(s=o.attr("data-url"))&&l(o,s);var r=o.data("fb_sels");if(r)for(i in r)if(n(i)){var d=i.split(/(?=[: ])/g),_=d[0];d[0]="";var u=d.join("");" "===u.substr(0,1)&&(u=u.substr(1));var g=o.closest(_);l(o,s=O.get(g,u),i)}}}},{rootMargin:"0px 1000px "+(w+w/2)+"px 1000px"}):null}}();